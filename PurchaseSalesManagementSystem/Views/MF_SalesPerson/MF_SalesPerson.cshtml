@{
    Layout = null;
}


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MF_SalesPerson Maintenance</title>
    <link href="~/lib/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="p-4 bg-light">

    <!-- ナビバー（Back to Menuエリア） -->
    <nav class="navbar navbar-dark bg-dark mb-4">
        <div class="container-fluid">
            <a class="navbar-brand" href="/Home/Menu">← Back to Menu</a>
            <span class="text-white">MF_SalesPerson Maintenance</span>
        </div>
    </nav>

    <!-- ▼ 左端揃え（Back to Menu と同じ位置） -->
    <div style="max-width:700px; margin-left:0; margin-right:auto;">
        <h3 class="mb-3">MF_SalesPerson Table Maintenance</h3>

        <!-- 検索フォーム -->
        <form id="searchForm" class="d-flex mb-3">
            <input type="text" id="searchCode" class="form-control me-2" placeholder="Enter CustomerCode">
            <button type="submit" class="btn btn-primary">Search</button>
        </form>

        <!-- データ表示テーブル -->
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>CustomerCode</th>
                    <th>SalesPerson</th>
                    <th>Select</th>
                </tr>
            </thead>
            <tbody id="dataBody"></tbody>
        </table>

        <!-- Action ボタン -->
        <div id="actionArea" class="mt-3" style="display:none;">
            <button class="btn btn-success me-2" onclick="updateSelected()">Update</button>
            <button class="btn btn-danger" onclick="deleteSelected()">Delete</button>
        </div>
    </div>


    <script>
        // ダミーデータ（実際はAPIから取得）
        let data = [
            { CustomerCode: "C001", SalesPerson: "Tanaka" },
            { CustomerCode: "C002", SalesPerson: "Suzuki" },
            { CustomerCode: "C003", SalesPerson: "Yamada" }
        ];

        function renderTable(records) {
            const body = document.getElementById("dataBody");
            body.innerHTML = "";

            records.forEach((row, index) => {
                body.innerHTML += `
                            <tr>
                                <td>${row.CustomerCode}</td>
                                <td><input type="text" value="${row.SalesPerson}" id="sp_${index}" class="form-control"></td>
                                <td><input type="checkbox" id="chk_${index}"></td>
                            </tr>
                        `;
            });

            document.getElementById("actionArea").style.display = records.length ? "block" : "none";
        }

        function updateSelected() {
            const updated = [];
            data.forEach((row, index) => {
                const chk = document.getElementById("chk_" + index);
                if (chk && chk.checked) {
                    row.SalesPerson = document.getElementById("sp_" + index).value;
                    updated.push(row);
                }
            });
            alert("Updated: " + JSON.stringify(updated));
        }

        function deleteSelected() {
            const remaining = [];
            const deleted = [];
            data.forEach((row, index) => {
                const chk = document.getElementById("chk_" + index);
                if (chk && chk.checked) {
                    deleted.push(row);
                } else {
                    remaining.push(row);
                }
            });
            data = remaining;
            alert("Deleted: " + JSON.stringify(deleted));
            renderTable(data);
        }

        // 検索
        document.getElementById("searchForm").addEventListener("submit", function (e) {
            e.preventDefault();
            const code = document.getElementById("searchCode").value.trim();
            const filtered = code ? data.filter(d => d.CustomerCode.includes(code)) : data;
            renderTable(filtered);
        });
    </script>
</body>
</html>
